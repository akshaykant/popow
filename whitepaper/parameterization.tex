\section{Implementation \& Parameters}

\begin{table}
  \caption{
    \label{table.size}
    Size of NIPoPoWs applied to Bitcoin today
    ($\approx$450k blocks) for various values of $m$,
    setting $k = 6$.
    %and with current values for transaction count, block count,
    %coinbase size and hash output length.
  }
  \centering
  \begin{tabular}{l|l|l|l}
      {\bf m}  & {\bf NIPoPoW size} & {\bf Blocks} & {\bf
      Hashes}\\
      \hline
      $6$   & $70$  kB & $108$ & $1440$  \\
      $15$  & $146$ kB & $231$ & $2925$  \\
      $30$  & $270$ kB & $426$ & $5400$  \\
      $50$  & $412$ kB & $656$ & $8250$ \\
      $100$ & $750$ kB & $1206$ & $15000$ \\
      $127$ & $952$ kB & $1530$ & $19050$ \\
  \end{tabular}
\end{table}

\subsection{Choosing Secure Parameters} To determine concrete values for
security parameter $m$, we focus on a particular adversarial strategy and
analyze its probability of success. This adversarial strategy is only one
possible strategy; an advanced adversary can perform more sophisticated attacks.
However, the fact that this attack is reasonable and possible to simulate allows
us to extract specific values for $m$. The attack is an extension of the
stochastic processes described in \cite{bitcoin} and \cite{rosenfeld}.

The experiment works as follows: $m$ is fixed and some adversarial computational
power percentage $q$ of the total network computational power is chosen. $k$ is
chosen based on $q$ according to Nakamoto \cite{bitcoin}. The number of blocks
$y$ during which parallel mining will occur is also fixed. The experiment begins
with the adversary and honest parties sharing a common blockchain which ends in
block $B$. After $B$ is mined, the adversary starts mining in secret and in
parallel with the honest parties on his own private fork on top of $B$. She
ignores the honest chain, so that the two chains remain disjoint after $B$. As
soon as $y$ blocks have been mined in total, the adversary attempts a double
spend by creating two conflicting transactions which are committed to an honest
block and an adversarial block respectively on top of each current chain.
Finally, the adversary mines $k$ blocks on top of the double spending
transaction within her private chain. After these $k$ blocks have been mined,
she publishes her private chain in an attempt to overcome the honest chain.

We measure the probability of success of this attack. We experiment with various
values of $m$ for $y = 100$, indicating $100$ blocks of secret parallel mining.
We make the assumption that honest party communication is perfect and immediate.
We ran $1,000,000$ Monte Carlo executions \footnote{The URL to the GitHub
repository of this MIT-licensed experiment has been redacted for anonymity and
will be provided in the proceedings version.} of the experiment for each value
of $m$ from $1$ to $30$. We ran the simulation for values of computational power
percentage $q = 0.1$, $q = 0.2$ and $q = 0.3$. The results are plotted in
Figure~\ref{fig.nipopow-attack-experiment}.

\begin{figure}
    \caption{\label{fig.nipopow-attack-experiment}
        Simulation results for a private mining attacker with $k$ according to
        Nakamoto and parallel mining parameter $y = 100$. Probabilities in
        logarithmic scale. The horizontal line indicates the threshold
        probability of \cite{bitcoin} is indicated by the horizontal line.
    }
    \centering
    \iftwocolumn
        \includegraphics[width=\columnwidth,keepaspectratio]{figures/nipopow-attack-experiment.png}
    \else
        \includegraphics[width=0.5\columnwidth,keepaspectratio]{figures/nipopow-attack-experiment-onecolumn.png}
    \fi
\end{figure}

Based on this data, we conclude that $m = 5$ is sufficient to achieve a $0.001$
probability of failure against an adversary with $10\%$ mining power. To secure
against an adversary with more than $30\%$ mining power, a choice of $m = 15$ is
needed.
