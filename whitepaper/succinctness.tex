%\subsection{Succinctness}
\label{sec.succinctness}

\noindent{\bf Succinctness.} 
We now prove that our construction produces succinct proofs.
%
We first observe that full succinctness in the standard honest majority model is
impossible to prove for our construction. To see why, recall that an adversary
with sufficiently large mining power can significantly harm superquality as
described in %Subsection
Section~\ref{subsec.superquality-attack}. By reducing
 superquality for a sufficiently low level $\mu$, for example $\mu = 3$, the
adversary can cause the honest prover to digress in their proofs from high-level
superchains down to low-level superchains, causing a linear proof to be
produced.
%For instance, if superquality is harmed at $\mu = 3$, the prover will
% need to digress down to level $\mu = 2$ and include the whole $2$-superchain,
% which, in expectation, will be of size $|\chain|/2$.

Having established security in the general case of the standard honest majority
model, we now concentrate our succinctness claims to the particular
``optimistic'' case where the adversary does not use their (minority)
computational power or network power. Therefore, the superquality of the chain
must be the same as a fully honestly-generated chain generated with no network
adversary. Last, for now, we will not allow the adversary to produce any proofs;
that is, all proofs consumed by the verifier are honestly-generated. We will
lift this last assumption shortly.

\begin{restatable}[Number of levels]{theorem}{restateThmFewLevels}
    \label{thm.few-levels}
    The number of superblock levels which have at least $m$ blocks are at most
    $\log(|S|)$, where $S$ is the set of all blocks produced, with overwhelming
    probability in $m$.
\end{restatable}

\ifonecolumn
\import{./}{proofs/fewlevels.tex}
\fi

The above theorem establishes that the number of superchains is small. What
remains to be shown is that few blocks will be included at each superchain
level.

\begin{restatable}[Large upchain expansion]{theorem}{restateThmLargeExpansion}
    \label{thm.large-expansion}
    Let $\chain$ be an honestly generated chain and let
    $\chain' = \chain\upchain^{\mu - 1}[i:i + \ell]$ with $\ell \geq 4m$.
    Then $|\chain'\upchain^\mu| \geq m$
    with overwhelming probability in $m$.
\end{restatable}

\ifonecolumn
\import{./}{proofs/largeexpansion.tex}
\fi

\begin{restatable}[Small downchain support]{corollary}{restateThmSmallSupport}
    \label{crly.small-support}
    Assume an honestly generated chain $\chain$ and let $\chain' = \chain\upchain^\mu[i:i + m]$. Then
    $|\chain'\downchain\upchain^{\mu - 1}| \leq 4m$
    with overwhelming probability in $m$.
\end{restatable}

\ifonecolumn
\import{./}{proofs/smallsupport.tex}
\fi

This last theorem establishes the fact that the support of blocks needed under
the $m$-sized chain suffix to move from one level to the one below is small.
Based on this, we can establish our theorem on succinctness:

\begin{restatable}[Optimistic succinctness]{theorem}{restateThmSuccinctness}
    \label{thm.succinctness}
    Non-interactive proofs-of-proof-of-work produced by honest provers in the
    optimistic case are succinct with the number of blocks bounded by $4m
    \log(|\chain|)$, with overwhelming probability in $m$.
\end{restatable}

Note the linear dependency between the round $r$ that a proof is generated 
and the length $|\chain|$ of the chain of each honest prover. 

\ifonecolumn
\import{./}{proofs/succinctness.tex}
\else
\fi

\noindent 
\textbf{Certificates of badness and denial of service attacks.} 
In summary, with our arguments so far,  we proved security in the general case (for any adversarial behavior)  and succinctness only in the optimistic case where the adversary does not interfere with superchain quality. 
In this setting, it is possible for the
adversary to produce large dummy (incorrect) proofs that 
expand the verification time; security will not be hurt but it would take more time to complete verification. One may dismiss this as a trivial denial of
service attack (and have a resource bounded
verifier simply stop  if it is confronted with such a processing task).  
Nevertheless, it would be useful for honest provers
to have the ability to signal to the 
verifier that such time expansion is indeed necessary because
of an attack on superchain quality rather than because 
a malicious prover is simply sending long proofs that will eventually
be rejected. With such signaling mechanism, a resource bounded verifier can 
distinguish between a denial of service attack that may be directed solely to it
from  a denial of service attack that is launched system-wide 
and interferes globally with superchain quality. 

 To facilitate the above signaling, we offer a simple generalization of our
construction that achieves this.
%Our extended construction allows 
%the verifier to stop processing
%input early, in a streaming fashion, thereby only requiring logarithmic
%communication complexity per proof received. To achieve 
%this, observe that honest proofs need to
%be large only if there is a violation of \textit{goodness}. However, goodness is
%not harmed when the chain is not under attack by the adversarial computational
%power or network. As such, 
Specifically, we require the prover to produce a
\textit{certificate of badness} in case there is a violation of
\textit{goodness} in the blockchain. This certificate will always be logarithmic
in size and must be sent prior to the rest of the proof by the prover to the
verifier. Because the certificate will be logarithmic in size even in the case
of an adversarial attack on the chain, the honest verifier can stop processing
the certificate after a logarithmic time bound. If the certificate is claimed to
be longer, the honest verifier can reject early by deciding that the prover is
adversarial. Looking at the certificate, the honest verifier determines whether
there is a possibility for a lack of goodness in the underlying chain. 
%If there's no adversarial computational power in use, the certificate is impossible to produce.

The certificates of badness are produced easily as follows. First, the honest verifier
finds the maximum level $\text{max-}\mu$ at which there are at least $m$
$\text{max-}\mu$-superblocks and includes it in the certificate. Then, because
there is a violation of goodness there must exist two levels $\mu < \mu'$ such
that $2^\mu|\chain\upchain^\mu| > (1 + \delta)2^{\mu'}|\chain\upchain^{\mu'}|$
in some part $\chain$ of the honestly adopted chain. But $\mu' - \mu \leq
\text{max-}\mu$. Therefore, there must exist two adjacent levels $\mu_1 < \mu_2$
which break goodness but with error parameter $(1 +
\delta)^{1/{\text{max-}\mu}}$. In particular, it will hold that
$2^{\mu_1}|\chain\upchain^{\mu_1}| > (1 +
\delta)^{1/{\text{max-}\mu}}2^{\mu_2}|\chain\upchain^{\mu_2}|$. This condition
is direct for the prover to find and trivial for the verifier to check and
completes the construction.
% Note that it is possible that a certificate of
% badness is produceable where two adjacent levels have more than $(1 +
% \delta)^{1/{\text{max-}\mu}}$ error even if there is no harm to global goodness;
% however, these certificates cannot be produced when no adversarial power is in
% use.
